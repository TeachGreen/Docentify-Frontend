<div class="step-page-wrapper container py-4">
  <h2>Trilha de criação de curso</h2>

  <app-step
    [steps]="userSteps"
    (stepClick)="onStepClick($event)">
  </app-step>

  <!-- Botão global de edição -->
  <div class="d-flex gap-2 my-3">
    <button class="btn btn-editar-verde my-3" (click)="toggleEditMode()">
      {{ editMode ? 'Concluir edição' : 'Editar etapa' }}
    </button>

    <button
      *ngIf="editMode"
      class="btn btn-success"
      (click)="atualizarEtapa()">
      Salvar alterações
    </button>
  </div>

  <!-- Etapa 0: Conteúdo em PDF -->
  <div *ngIf="selectedStepIndex === 0">
    <h4>Envio de conteúdo em PDF</h4>
    <input type="file" accept=".pdf" multiple (change)="onFileUpload($event)" />

    <div class="mt-3">
      <h6>Arquivos enviados:</h6>
      <ul *ngIf="arquivosDaEtapaSelecionada.length > 0; else nenhumArquivo">
        <li *ngFor="let file of arquivosDaEtapaSelecionada; let i = index">
          {{ file.name }}
          <button
            *ngIf="editMode"
            class="btn btn-sm btn-danger ms-2"
            (click)="removerArquivo(i)">
            Remover
          </button>
        </li>
      </ul>
      <ng-template #nenhumArquivo>
        <p class="text-muted">Nenhum arquivo enviado ainda.</p>
      </ng-template>
    </div>
  </div>

  <!-- Etapa 1: Vídeos -->
  <div *ngIf="selectedStepIndex === 1">
    <h4>Envio de vídeos</h4>
    <input type="file" accept="video/*" (change)="onFileUpload($event)" />

    <div class="my-3">
      <label for="youtubeUrl">Ou insira uma URL do YouTube:</label>
      <input
        id="youtubeUrl"
        type="text"
        class="form-control my-2"
        placeholder="https://youtube.com/..."
        [(ngModel)]="youtubeUrl" />
      <button class="btn btn-primary" (click)="adicionarVideoUrl()">Adicionar vídeo</button>
    </div>

    <div class="mt-3" *ngIf="arquivosDaEtapaSelecionada.length > 0">
      <h6>Vídeos enviados:</h6>
      <ul>
        <li *ngFor="let file of arquivosDaEtapaSelecionada; let i = index">
          {{ file.name }}
          <button
            *ngIf="editMode"
            class="btn btn-sm btn-danger ms-2"
            (click)="removerArquivo(i)">
            Remover
          </button>
        </li>
      </ul>
    </div>
  </div>

  <!-- Etapa 2: Atividades -->
  <div *ngIf="selectedStepIndex === 2">
    <h4>Envio de tarefas (PDF)</h4>
    <input type="file" accept=".pdf" (change)="onFileUpload($event)" />

    <div class="mt-3" *ngIf="arquivosDaEtapaSelecionada.length > 0">
      <h6>Arquivos enviados:</h6>
      <ul>
        <li *ngFor="let file of arquivosDaEtapaSelecionada; let i = index">
          {{ file.name }}
          <button
            *ngIf="editMode"
            class="btn btn-sm btn-danger ms-2"
            (click)="removerArquivo(i)">
            Remover
          </button>
        </li>
      </ul>
    </div>
  </div>

  <!-- Etapa 3: Quiz -->
  <div *ngIf="selectedStepIndex === 3">
    <h4>Criação de quiz de avaliação</h4>
    <p>Você poderá adicionar até 20 perguntas com até 4 alternativas cada.</p>
    <button class="btn btn-primary">Criar Quiz</button>
  </div>

  <!-- Etapa 4: Certificado -->
  <div *ngIf="selectedStepIndex === 4">
    <h4>Envio de modelo de certificado (PDF)</h4>
    <input type="file" accept=".pdf" (change)="onFileUpload($event)" />

    <div class="mt-3" *ngIf="arquivosDaEtapaSelecionada.length > 0">
      <h6>Certificado enviado:</h6>
      <ul>
        <li *ngFor="let file of arquivosDaEtapaSelecionada; let i = index">
          {{ file.name }}
          <button
            *ngIf="editMode"
            class="btn btn-sm btn-danger ms-2"
            (click)="removerArquivo(i)">
            Remover
          </button>
        </li>
      </ul>
    </div>
  </div>
</div>
